<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <script src="../../../../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../../../../../bower_components/web-component-tester/browser.js"></script>

  <script>
    var App = {}; // jshint ignore:line
  </script>
  <link rel="import" href="../indicators-filters.html">
</head>
<body>
  <test-fixture id="indicators-filters">
    <template>
      <indicators-filters query="[[query]]"
                          params="[[queryParams]]">
      </indicators-filters>
    </template>
  </test-fixture>

  <script>
    suite('<indicators-filters>', function () {
      var clock;
      var el;
      var field;

      setup(function() {
        clock = sinon.useFakeTimers();

        el = fixture('indicators-filters');

        checkboxFilter = Polymer.dom(Polymer.dom(el.root)
            .querySelector('checkbox-filter').root);

        checkbox = Polymer.dom(checkboxFilter.querySelector('paper-checkbox')
            .root).querySelector('#checkbox');

        // paperCheckbox = Polymer.dom(checkboxFilter)
        //     .querySelector('paper-checkbox');
        //
        // checkboxFilterElement = Polymer.dom(Polymer.dom(el.root))
        //     .querySelector('checkbox-filter');
        //
        dropdownFilter = Polymer.dom(Polymer.dom(el.root)
            .querySelector('dropdown-filter[name="pd_statuses"]').root);

        dropdownMenu = Polymer.dom(Polymer.dom(dropdownFilter))
            .querySelector('paper-dropdown-menu');

        clickCheckbox = function() {
          checkbox.dispatchEvent(new Event('click', {
            bubbles: true,
          }));
        };

      });

      test('checkbox not checked by default', function() {
        assert.isNotTrue(checkbox.classList.contains('checked'));
      });

      test('PD dropdowns are enabled by default', function() {
        assert.isNotTrue(dropdownMenu.disabled);
      });

      test('when "Active PDs Only" is checked, the PD filter is disabled', function() {

        clickCheckbox();

        assert.isTrue(checkbox.classList.contains('checked'));

        // TODO: To check disabling, need to trigger change query params.
        // assert.isTrue(dropdownMenu.disabled);
        // assert.equal(el.queryParams.pd_active, 1);

      });

    });

  </script>
</body>
</html>
